<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Reframer – Say it so it lands</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #f5f5f4;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 16px;
    }
    
    .phone-frame {
      width: 100%;
      max-width: 390px;
      background: white;
      border-radius: 32px;
      box-shadow: 0 25px 50px -12px rgba(0,0,0,0.2);
      padding: 24px;
      min-height: 750px;
      max-height: 90vh;
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }
    
    /* Header */
    .header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 16px;
      flex-shrink: 0;
      transition: opacity 0.3s;
    }
    
    .header.hidden {
      opacity: 0;
      pointer-events: none;
    }
    
    .logo {
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .logo-icon {
      width: 36px;
      height: 36px;
      border: 2px solid #292524;
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      font-size: 16px;
    }
    
    .logo-text {
      font-weight: 600;
      color: #292524;
      font-size: 18px;
    }
    
    .screen-label {
      font-size: 12px;
      color: #a8a29e;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    
    /* Progress */
    .progress {
      display: flex;
      gap: 6px;
      justify-content: center;
      margin-bottom: 24px;
      flex-shrink: 0;
      transition: opacity 0.3s;
    }
    
    .progress.hidden {
      opacity: 0;
    }
    
    .progress-dot {
      height: 6px;
      width: 6px;
      border-radius: 3px;
      background: #e7e5e4;
      transition: all 0.3s;
    }
    
    .progress-dot.active {
      width: 28px;
      background: #292524;
    }
    
    .progress-dot.completed {
      background: #a8a29e;
    }
    
    /* Content */
    .content {
      flex: 1;
      overflow-y: auto;
      overflow-x: hidden;
    }
    
    .screen {
      display: none;
    }
    
    .screen.active {
      display: block;
    }
    
    /* ========== LANDING PAGE ========== */
    
    .landing {
      display: flex;
      flex-direction: column;
      min-height: 580px;
      text-align: center;
    }
    
    .landing-hero {
      flex: 1;
      display: flex;
      flex-direction: column;
      justify-content: center;
      padding: 20px 0;
    }
    
    .landing-logo {
      width: 80px;
      height: 80px;
      border: 3px solid #292524;
      border-radius: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      font-size: 36px;
      margin: 0 auto 24px;
      color: #292524;
    }
    
    .landing-title {
      font-size: 36px;
      font-weight: 700;
      color: #292524;
      margin-bottom: 8px;
      line-height: 1.1;
    }
    
    .landing-tagline {
      font-size: 20px;
      color: #78716c;
      margin-bottom: 40px;
      line-height: 1.4;
    }
    
    .landing-visual {
      padding: 24px 20px;
      background: #fafaf9;
      border-radius: 16px;
      margin-bottom: 40px;
      text-align: center;
    }
    
    .visual-before {
      font-size: 14px;
      color: #a8a29e;
      margin-bottom: 12px;
      text-decoration: line-through;
    }
    
    .visual-arrow {
      font-size: 18px;
      color: #d6d3d1;
      margin: 8px 0;
    }
    
    .visual-after {
      font-size: 16px;
      color: #292524;
      font-weight: 500;
      line-height: 1.4;
    }
    
    .landing-cta {
      margin-top: auto;
    }
    
    .btn-primary {
      width: 100%;
      padding: 16px;
      border: 2px solid #292524;
      border-radius: 14px;
      background: #292524;
      color: white;
      font-size: 16px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s;
    }
    
    .btn-primary:hover {
      background: #1c1917;
    }
    
    .btn-primary:disabled {
      background: #e7e5e4;
      border-color: #e7e5e4;
      color: #a8a29e;
      cursor: not-allowed;
    }
    
    .landing-footer {
      margin-top: 16px;
      font-size: 13px;
      color: #a8a29e;
    }
    
    /* ========== INTRO SCREENS ========== */
    
    .intro {
      display: flex;
      flex-direction: column;
      min-height: 580px;
      text-align: center;
    }
    
    .intro-content {
      flex: 1;
      display: flex;
      flex-direction: column;
      justify-content: center;
      padding: 20px 0;
    }
    
    .intro-icon {
      width: 72px;
      height: 72px;
      border: 2px solid #292524;
      border-radius: 18px;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto 28px;
    }
    
    .intro-icon svg {
      width: 36px;
      height: 36px;
      stroke: #292524;
      stroke-width: 2;
      fill: none;
    }
    
    .intro-icon-row {
      display: flex;
      gap: 16px;
      justify-content: center;
      margin-bottom: 28px;
    }
    
    .intro-icon-small {
      width: 56px;
      height: 56px;
      border: 2px solid #292524;
      border-radius: 14px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .intro-icon-small svg {
      width: 28px;
      height: 28px;
      stroke: #292524;
      stroke-width: 2;
      fill: none;
    }
    
    .intro-number {
      font-size: 13px;
      font-weight: 600;
      color: #a8a29e;
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-bottom: 12px;
    }
    
    .intro-title {
      font-size: 26px;
      font-weight: 600;
      color: #292524;
      margin-bottom: 16px;
      line-height: 1.2;
    }
    
    .intro-desc {
      font-size: 16px;
      color: #57534e;
      line-height: 1.6;
      max-width: 300px;
      margin: 0 auto;
    }
    
    .intro-desc strong {
      color: #292524;
      font-weight: 600;
    }
    
    .intro-dots {
      display: flex;
      gap: 8px;
      justify-content: center;
      margin: 40px 0;
    }
    
    .intro-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: #e7e5e4;
      transition: background 0.3s;
    }
    
    .intro-dot.active {
      background: #292524;
    }
    
    .intro-nav {
      margin-top: auto;
      display: flex;
      gap: 12px;
    }
    
    .btn-secondary {
      flex: 1;
      padding: 16px 20px;
      border: 2px solid #e7e5e4;
      border-radius: 14px;
      background: white;
      color: #57534e;
      font-size: 16px;
      cursor: pointer;
      transition: border-color 0.2s;
    }
    
    .btn-secondary:hover {
      border-color: #292524;
    }
    
    .btn-text {
      width: 100%;
      padding: 12px;
      border: none;
      background: none;
      color: #78716c;
      font-size: 14px;
      cursor: pointer;
      margin-top: 8px;
    }
    
    .btn-text:hover {
      color: #292524;
    }
    
    /* ========== REST OF APP STYLES ========== */
    
    h1 {
      font-size: 26px;
      font-weight: 600;
      color: #292524;
      text-align: center;
      margin-bottom: 8px;
      line-height: 1.2;
    }
    
    h2 {
      font-size: 20px;
      font-weight: 600;
      color: #292524;
      margin-bottom: 16px;
    }
    
    .subtitle {
      font-size: 15px;
      color: #78716c;
      text-align: center;
      margin-bottom: 24px;
    }
    
    /* Mode selector */
    .mode-selector {
      display: flex;
      gap: 12px;
      margin-bottom: 32px;
    }
    
    .mode-card {
      flex: 1;
      padding: 20px 16px;
      border: 2px solid #e7e5e4;
      border-radius: 16px;
      background: white;
      cursor: pointer;
      text-align: center;
      transition: all 0.2s;
    }
    
    .mode-card:hover {
      border-color: #292524;
    }
    
    .mode-card.selected {
      border-color: #292524;
      background: #fafaf9;
    }
    
    .mode-icon {
      width: 48px;
      height: 48px;
      margin: 0 auto 12px;
      border: 2px solid #292524;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .mode-icon svg {
      width: 24px;
      height: 24px;
      stroke: #292524;
      stroke-width: 2;
      fill: none;
    }
    
    .mode-title {
      font-weight: 600;
      color: #292524;
      margin-bottom: 4px;
    }
    
    .mode-desc {
      font-size: 13px;
      color: #78716c;
    }
    
    /* Form elements */
    textarea, input[type="text"] {
      width: 100%;
      padding: 16px;
      border: 2px solid #e7e5e4;
      border-radius: 14px;
      font-size: 15px;
      color: #292524;
      resize: none;
      transition: border-color 0.2s;
      font-family: inherit;
      line-height: 1.5;
    }
    
    textarea:focus, input[type="text"]:focus {
      outline: none;
      border-color: #292524;
    }
    
    textarea::placeholder, input::placeholder {
      color: #a8a29e;
    }
    
    textarea {
      height: 120px;
    }
    
    label {
      display: block;
      font-size: 14px;
      color: #57534e;
      margin-bottom: 8px;
      font-weight: 500;
    }
    
    label span {
      color: #a8a29e;
      font-weight: 400;
    }
    
    .form-group {
      margin-bottom: 20px;
    }
    
    /* Reaction grid */
    .reaction-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 10px;
    }
    
    .reaction-btn {
      padding: 14px 12px;
      border: 2px solid #e7e5e4;
      border-radius: 12px;
      background: white;
      cursor: pointer;
      text-align: left;
      font-size: 14px;
      color: #292524;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .reaction-btn:hover {
      border-color: #d6d3d1;
    }
    
    .reaction-btn.selected {
      border-color: #292524;
      background: #fafaf9;
    }
    
    .reaction-icon {
      width: 32px;
      height: 32px;
      border: 1.5px solid #292524;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
    }
    
    .reaction-icon svg {
      width: 18px;
      height: 18px;
      stroke: #292524;
      stroke-width: 2;
      fill: none;
    }
    
    /* Buttons */
    .btn-outline {
      width: 100%;
      padding: 16px;
      border: 2px solid #292524;
      border-radius: 14px;
      background: white;
      color: #292524;
      font-size: 16px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s;
      margin-top: 10px;
    }
    
    .btn-outline:hover {
      background: #fafaf9;
    }
    
    .btn-outline:disabled {
      border-color: #e7e5e4;
      color: #a8a29e;
      cursor: not-allowed;
    }
    
    .btn-ghost {
      width: 100%;
      padding: 14px;
      border: 2px dashed #d6d3d1;
      border-radius: 14px;
      background: white;
      color: #78716c;
      font-size: 15px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s;
      margin-top: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }
    
    .btn-ghost:hover {
      border-color: #292524;
      color: #292524;
    }
    
    .btn-ghost svg {
      width: 18px;
      height: 18px;
      stroke: currentColor;
      stroke-width: 2;
      fill: none;
    }
    
    .btn-row {
      display: flex;
      gap: 12px;
      margin-top: 16px;
    }
    
    .btn-row .btn-primary,
    .btn-row .btn-outline,
    .btn-row .btn-secondary {
      flex: 1;
      margin-top: 0;
    }
    
    /* Cards */
    .card {
      padding: 20px;
      border-radius: 16px;
      margin-bottom: 14px;
      border: 2px solid;
    }
    
    .card-default {
      background: #fafaf9;
      border-color: #e7e5e4;
    }
    
    .card-highlight {
      background: white;
      border-color: #292524;
    }
    
    .card-label {
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.8px;
      margin-bottom: 10px;
      color: #78716c;
    }
    
    .card p {
      font-size: 15px;
      color: #292524;
      line-height: 1.55;
    }
    
    .card p.muted {
      font-size: 14px;
      color: #78716c;
    }
    
    /* Technique cards */
    .technique-card {
      width: 100%;
      padding: 20px;
      border: 2px solid #e7e5e4;
      border-radius: 16px;
      background: white;
      cursor: pointer;
      text-align: left;
      margin-bottom: 14px;
      transition: all 0.2s;
    }
    
    .technique-card:hover {
      border-color: #292524;
    }
    
    .technique-card.recommended {
      border-color: #292524;
      background: #fafaf9;
    }
    
    .technique-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 12px;
    }
    
    .technique-meta {
      font-size: 12px;
      color: #78716c;
      margin-bottom: 2px;
    }
    
    .technique-name {
      font-size: 17px;
      font-weight: 600;
      color: #292524;
    }
    
    .technique-score {
      text-align: right;
    }
    
    .score-value {
      font-size: 24px;
      font-weight: 700;
      color: #292524;
    }
    
    .score-label {
      font-size: 11px;
      color: #78716c;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    
    .technique-desc {
      font-size: 14px;
      color: #57534e;
      line-height: 1.5;
      margin-bottom: 14px;
    }
    
    .technique-example {
      padding: 14px;
      background: #f5f5f4;
      border-radius: 10px;
      font-size: 14px;
      color: #292524;
      font-style: italic;
      margin-bottom: 12px;
      border-left: 3px solid #292524;
    }
    
    .badge-row {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }
    
    .badge {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 4px 10px;
      border-radius: 6px;
      font-size: 12px;
      font-weight: 500;
      background: #f5f5f4;
      color: #57534e;
    }
    
    .badge.dark {
      background: #292524;
      color: white;
    }
    
    .badge.new {
      background: #fef3c7;
      color: #92400e;
    }
    
    /* Reframe options */
    .reframe-option {
      width: 100%;
      padding: 16px;
      border: 2px solid #e7e5e4;
      border-radius: 14px;
      background: white;
      cursor: pointer;
      text-align: left;
      margin-bottom: 10px;
      transition: all 0.2s;
      position: relative;
    }
    
    .reframe-option:hover {
      border-color: #d6d3d1;
    }
    
    .reframe-option.selected {
      border-color: #292524;
      background: #fafaf9;
    }
    
    .reframe-checkbox {
      position: absolute;
      top: 16px;
      right: 16px;
      width: 24px;
      height: 24px;
      border: 2px solid #d6d3d1;
      border-radius: 6px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s;
    }
    
    .reframe-option.selected .reframe-checkbox {
      background: #292524;
      border-color: #292524;
    }
    
    .reframe-checkbox svg {
      width: 14px;
      height: 14px;
      stroke: white;
      stroke-width: 3;
      fill: none;
      opacity: 0;
    }
    
    .reframe-option.selected .reframe-checkbox svg {
      opacity: 1;
    }
    
    .reframe-header {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 6px;
    }
    
    .reframe-axis {
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      color: #78716c;
    }
    
    .reframe-text {
      font-size: 15px;
      color: #292524;
      line-height: 1.5;
      padding-right: 36px;
    }
    
    .selection-count {
      text-align: center;
      font-size: 14px;
      color: #78716c;
      margin-bottom: 16px;
    }
    
    .selection-count strong {
      color: #292524;
    }
    
    .selection-minimum {
      color: #a8a29e;
    }
    
    /* Technique Primary Card */
    .technique-primary {
      padding: 20px;
      border: 2px solid #292524;
      border-radius: 16px;
      background: #fafaf9;
      margin-bottom: 24px;
    }
    
    .technique-primary-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 12px;
    }
    
    .technique-primary-label {
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      color: #78716c;
      margin-bottom: 4px;
    }
    
    .technique-primary-name {
      font-size: 20px;
      font-weight: 600;
      color: #292524;
    }
    
    .technique-primary-desc {
      font-size: 14px;
      color: #57534e;
      line-height: 1.5;
      margin-bottom: 12px;
    }
    
    .btn-change-technique {
      padding: 8px 14px;
      border: 1.5px solid #d6d3d1;
      border-radius: 8px;
      background: white;
      font-size: 13px;
      color: #57534e;
      cursor: pointer;
      transition: border-color 0.2s;
    }
    
    .btn-change-technique:hover {
      border-color: #292524;
    }
    
    /* Styling Section */
    .styling-section {
      margin-bottom: 24px;
    }
    
    .styling-header {
      display: flex;
      align-items: baseline;
      gap: 8px;
      margin-bottom: 16px;
    }
    
    .styling-title {
      font-size: 15px;
      font-weight: 600;
      color: #292524;
    }
    
    .styling-optional {
      font-size: 12px;
      color: #a8a29e;
    }
    
    .styling-row {
      margin-bottom: 16px;
    }
    
    .styling-row-label {
      font-size: 13px;
      font-weight: 500;
      color: #57534e;
      margin-bottom: 8px;
    }
    
    .styling-pills {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
    }
    
    .styling-pill {
      padding: 8px 14px;
      border: 1.5px solid #e7e5e4;
      border-radius: 20px;
      background: white;
      font-size: 13px;
      color: #57534e;
      cursor: pointer;
      transition: all 0.15s;
    }
    
    .styling-pill:hover {
      border-color: #d6d3d1;
    }
    
    .styling-pill.active {
      background: #292524;
      border-color: #292524;
      color: white;
    }
    
    /* Reframe cards - simpler, no meta tags */
    .reframe-option {
      width: 100%;
      padding: 16px;
      border: 2px solid #e7e5e4;
      border-radius: 14px;
      background: white;
      cursor: pointer;
      text-align: left;
      margin-bottom: 10px;
      transition: all 0.2s;
      position: relative;
    }
    
    .reframe-option:hover {
      border-color: #d6d3d1;
    }
    
    .reframe-option.selected {
      border-color: #292524;
      background: #fafaf9;
    }
    
    .reframe-checkbox {
      position: absolute;
      top: 16px;
      right: 16px;
      width: 24px;
      height: 24px;
      border: 2px solid #d6d3d1;
      border-radius: 6px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s;
    }
    
    .reframe-option.selected .reframe-checkbox {
      background: #292524;
      border-color: #292524;
    }
    
    .reframe-checkbox svg {
      width: 14px;
      height: 14px;
      stroke: white;
      stroke-width: 3;
      fill: none;
      opacity: 0;
    }
    
    .reframe-option.selected .reframe-checkbox svg {
      opacity: 1;
    }
    
    .reframe-label {
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      color: #78716c;
      margin-bottom: 6px;
    }
    
    .reframe-text {
      font-size: 15px;
      color: #292524;
      line-height: 1.5;
      padding-right: 36px;
    }
    
    /* Result card with reasoning */
    .result-reasoning {
      font-size: 13px;
      color: #57534e;
      line-height: 1.5;
      padding: 12px;
      background: #f5f5f4;
      border-radius: 8px;
      margin-top: 12px;
      border-left: 3px solid #78716c;
    }
    
    .result-card.winner .result-reasoning {
      background: white;
      border-left-color: #292524;
    }
    
    /* Testing */
    .testing-container {
      text-align: center;
      padding: 40px 20px;
    }
    
    .testing-spinner {
      width: 56px;
      height: 56px;
      border: 3px solid #e7e5e4;
      border-top-color: #292524;
      border-radius: 50%;
      margin: 0 auto 24px;
      animation: spin 0.8s linear infinite;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    .testing-title {
      font-size: 18px;
      font-weight: 600;
      color: #292524;
      margin-bottom: 8px;
    }
    
    .testing-subtitle {
      font-size: 14px;
      color: #78716c;
      margin-bottom: 32px;
    }
    
    .testing-items {
      text-align: left;
      max-width: 280px;
      margin: 0 auto;
    }
    
    .testing-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px 0;
      border-bottom: 1px solid #e7e5e4;
      font-size: 14px;
      color: #78716c;
    }
    
    .testing-item:last-child {
      border-bottom: none;
    }
    
    .testing-item.done {
      color: #292524;
    }
    
    .testing-item-icon {
      width: 24px;
      height: 24px;
      border: 2px solid currentColor;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
    }
    
    .testing-item.done .testing-item-icon {
      background: #292524;
      border-color: #292524;
    }
    
    .testing-item-icon svg {
      width: 12px;
      height: 12px;
      stroke: white;
      stroke-width: 3;
      fill: none;
    }
    
    /* Results */
    .results-header {
      text-align: center;
      margin-bottom: 20px;
    }
    
    .results-audience {
      font-size: 13px;
      color: #78716c;
      margin-top: 4px;
    }
    
    .result-card {
      padding: 20px;
      border: 2px solid #e7e5e4;
      border-radius: 16px;
      margin-bottom: 12px;
      background: white;
    }
    
    .result-card.winner {
      border-color: #292524;
      background: #fafaf9;
    }
    
    .result-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 12px;
    }
    
    .result-rank {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .rank-badge {
      width: 28px;
      height: 28px;
      border: 2px solid #292524;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 14px;
      font-weight: 600;
      color: #292524;
    }
    
    .result-card.winner .rank-badge {
      background: #292524;
      color: white;
    }
    
    .result-axis {
      font-size: 15px;
      font-weight: 600;
      color: #292524;
    }
    
    .result-score {
      text-align: right;
    }
    
    .result-score-value {
      font-size: 28px;
      font-weight: 700;
      color: #292524;
    }
    
    .result-score-label {
      font-size: 11px;
      color: #78716c;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    
    .result-text {
      font-size: 14px;
      color: #57534e;
      line-height: 1.5;
      margin-bottom: 16px;
      padding: 14px;
      background: #f5f5f4;
      border-radius: 10px;
      border-left: 3px solid #292524;
    }
    
    .result-card.winner .result-text {
      background: white;
    }
    
    .result-metrics {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 8px;
    }
    
    .metric {
      display: flex;
      justify-content: space-between;
      font-size: 13px;
      padding: 8px 12px;
      background: #f5f5f4;
      border-radius: 8px;
    }
    
    .result-card.winner .metric {
      background: white;
    }
    
    .metric-label {
      color: #78716c;
    }
    
    .metric-value {
      font-weight: 600;
      color: #292524;
    }
    
    .winner-label {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 12px;
      background: #292524;
      color: white;
      font-size: 12px;
      font-weight: 600;
      border-radius: 6px;
      margin-bottom: 12px;
    }
    
    .result-card.collapsed {
      padding: 16px 20px;
    }
    
    .result-card.collapsed .result-text,
    .result-card.collapsed .result-metrics {
      display: none;
    }
    
    .result-card.collapsed .result-header {
      margin-bottom: 0;
    }
    
    /* Final screen */
    .success-header {
      text-align: center;
      margin-bottom: 24px;
    }
    
    .success-icon {
      width: 64px;
      height: 64px;
      border: 2px solid #292524;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto 16px;
    }
    
    .success-icon svg {
      width: 32px;
      height: 32px;
      stroke: #292524;
      stroke-width: 2.5;
      fill: none;
    }
    
    .final-reframe {
      padding: 24px 20px;
      background: #fafaf9;
      border: 2px solid #292524;
      border-radius: 16px;
      margin-bottom: 16px;
    }
    
    .final-reframe p {
      font-size: 17px;
      color: #292524;
      line-height: 1.6;
    }
    
    .summary-card {
      padding: 16px;
      background: #fafaf9;
      border: 1px solid #e7e5e4;
      border-radius: 12px;
      margin-bottom: 16px;
    }
    
    .summary-row {
      display: flex;
      justify-content: space-between;
      padding: 10px 0;
      border-bottom: 1px solid #e7e5e4;
    }
    
    .summary-row:last-child {
      border-bottom: none;
    }
    
    .summary-label {
      font-size: 13px;
      color: #78716c;
    }
    
    .summary-value {
      font-size: 13px;
      color: #292524;
      font-weight: 500;
      text-align: right;
    }
    
    .action-grid {
      display: grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap: 10px;
      margin-bottom: 16px;
    }
    
    .action-btn {
      padding: 14px 10px;
      border: 2px solid #e7e5e4;
      border-radius: 12px;
      background: white;
      cursor: pointer;
      font-size: 13px;
      color: #57534e;
      transition: border-color 0.2s;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 6px;
    }
    
    .action-btn:hover {
      border-color: #292524;
    }
    
    .action-btn svg {
      width: 20px;
      height: 20px;
      stroke: #292524;
      stroke-width: 2;
      fill: none;
    }
    
    /* ========== LEARNING MODE ========== */
    
    .learn-nav {
      display: flex;
      gap: 8px;
      margin-bottom: 24px;
      overflow-x: auto;
      padding-bottom: 4px;
    }
    
    .learn-nav-btn {
      padding: 10px 16px;
      border: 2px solid #e7e5e4;
      border-radius: 10px;
      background: white;
      font-size: 14px;
      font-weight: 500;
      color: #57534e;
      cursor: pointer;
      white-space: nowrap;
      transition: all 0.2s;
    }
    
    .learn-nav-btn:hover {
      border-color: #292524;
    }
    
    .learn-nav-btn.active {
      background: #292524;
      border-color: #292524;
      color: white;
    }
    
    .family-card {
      padding: 16px;
      border: 2px solid #e7e5e4;
      border-radius: 14px;
      background: white;
      margin-bottom: 10px;
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    
    .family-card:hover {
      border-color: #292524;
    }
    
    .family-info {
      flex: 1;
    }
    
    .family-name {
      font-size: 16px;
      font-weight: 600;
      color: #292524;
      margin-bottom: 4px;
    }
    
    .family-count {
      font-size: 13px;
      color: #78716c;
    }
    
    .family-arrow {
      width: 24px;
      height: 24px;
      stroke: #a8a29e;
      stroke-width: 2;
      fill: none;
    }
    
    .tech-list-item {
      padding: 14px 16px;
      border: 2px solid #e7e5e4;
      border-radius: 12px;
      background: white;
      margin-bottom: 8px;
      cursor: pointer;
      transition: all 0.2s;
    }
    
    .tech-list-item:hover {
      border-color: #292524;
    }
    
    .tech-list-name {
      font-size: 15px;
      font-weight: 500;
      color: #292524;
      margin-bottom: 4px;
    }
    
    .tech-list-desc {
      font-size: 13px;
      color: #78716c;
      line-height: 1.4;
    }
    
    /* Flashcard */
    .flashcard-container {
      perspective: 1000px;
      margin-bottom: 24px;
    }
    
    .flashcard {
      width: 100%;
      min-height: 280px;
      position: relative;
      transform-style: preserve-3d;
      transition: transform 0.5s;
      cursor: pointer;
    }
    
    .flashcard.flipped {
      transform: rotateY(180deg);
    }
    
    .flashcard-face {
      position: absolute;
      width: 100%;
      min-height: 280px;
      backface-visibility: hidden;
      border: 2px solid #292524;
      border-radius: 20px;
      padding: 24px;
      display: flex;
      flex-direction: column;
    }
    
    .flashcard-front {
      background: white;
    }
    
    .flashcard-back {
      background: #fafaf9;
      transform: rotateY(180deg);
    }
    
    .flashcard-label {
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.8px;
      color: #78716c;
      margin-bottom: 16px;
    }
    
    .flashcard-title {
      font-size: 22px;
      font-weight: 600;
      color: #292524;
      margin-bottom: 8px;
    }
    
    .flashcard-family {
      font-size: 14px;
      color: #78716c;
      margin-bottom: 16px;
    }
    
    .flashcard-content {
      font-size: 15px;
      color: #292524;
      line-height: 1.6;
      flex: 1;
    }
    
    .flashcard-hint {
      font-size: 13px;
      color: #a8a29e;
      text-align: center;
      margin-top: 16px;
    }
    
    .flashcard-nav {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .flashcard-nav-btn {
      width: 48px;
      height: 48px;
      border: 2px solid #e7e5e4;
      border-radius: 12px;
      background: white;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: border-color 0.2s;
    }
    
    .flashcard-nav-btn:hover {
      border-color: #292524;
    }
    
    .flashcard-nav-btn svg {
      width: 20px;
      height: 20px;
      stroke: #292524;
      stroke-width: 2;
      fill: none;
    }
    
    .flashcard-progress {
      font-size: 14px;
      color: #78716c;
    }
    
    .flashcard-progress strong {
      color: #292524;
    }
    
    /* Case study card */
    .case-card {
      border: 2px solid #e7e5e4;
      border-radius: 16px;
      overflow: hidden;
      margin-bottom: 14px;
      cursor: pointer;
      transition: border-color 0.2s;
    }
    
    .case-card:hover {
      border-color: #292524;
    }
    
    .case-header {
      padding: 16px;
      background: #fafaf9;
      border-bottom: 1px solid #e7e5e4;
    }
    
    .case-industry {
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      color: #78716c;
      margin-bottom: 4px;
    }
    
    .case-title {
      font-size: 16px;
      font-weight: 600;
      color: #292524;
    }
    
    .case-body {
      padding: 16px;
    }
    
    .case-before-after {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }
    
    .case-column {
      font-size: 13px;
    }
    
    .case-column-label {
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      color: #78716c;
      margin-bottom: 6px;
    }
    
    .case-column-text {
      color: #292524;
      line-height: 1.4;
    }
    
    .case-technique {
      margin-top: 12px;
      padding-top: 12px;
      border-top: 1px solid #e7e5e4;
      font-size: 13px;
    }
    
    .case-technique-label {
      color: #78716c;
    }
    
    .case-technique-name {
      font-weight: 600;
      color: #292524;
    }
    
    /* Helpers */
    .text-center { text-align: center; }
    .mb-8 { margin-bottom: 8px; }
    .mb-16 { margin-bottom: 16px; }
    .mb-24 { margin-bottom: 24px; }
    .mt-16 { margin-top: 16px; }
  </style>
</head>
<body>
  <div class="phone-frame">
    <!-- Header -->
    <div class="header hidden" id="header">
      <div class="logo">
        <div class="logo-icon">R</div>
        <span class="logo-text">Reframer</span>
      </div>
      <span class="screen-label" id="screenLabel">Start</span>
    </div>
    
    <!-- Progress -->
    <div class="progress hidden" id="progressBar">
      <div class="progress-dot" id="dot0"></div>
      <div class="progress-dot" id="dot1"></div>
      <div class="progress-dot" id="dot2"></div>
      <div class="progress-dot" id="dot3"></div>
      <div class="progress-dot" id="dot4"></div>
      <div class="progress-dot" id="dot5"></div>
    </div>
    
    <!-- Content -->
    <div class="content">
      
      <!-- ========== LANDING PAGE ========== -->
      <div class="screen active" id="screenLanding">
        <div class="landing">
          <div class="landing-hero">
            <div class="landing-logo">R</div>
            <h1 class="landing-title">Reframer</h1>
            <p class="landing-tagline">Say it so it lands.</p>
            
            <div class="landing-visual">
              <div class="visual-before">"We're not the biggest car rental company."</div>
              <div class="visual-arrow">↓</div>
              <div class="visual-after">"We're #2. We try harder."</div>
            </div>
          </div>
          
          <div class="landing-cta">
            <button class="btn-primary" onclick="goToScreen('intro1')">Get started</button>
            <p class="landing-footer">58 techniques · Based on behavioral science</p>
          </div>
        </div>
      </div>
      
      <!-- ========== INTRO FLOW ========== -->
      <div class="screen" id="screenIntro1">
        <div class="intro">
          <div class="intro-content">
            <div class="intro-icon">
              <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>
            </div>
            <div class="intro-number">The problem</div>
            <h2 class="intro-title">Messages fail for predictable reasons</h2>
            <p class="intro-desc">Confusion. Fear. Identity threat. Blame. When your message isn't landing, there's usually a diagnosable cause.</p>
          </div>
          
          <div class="intro-dots">
            <div class="intro-dot active"></div>
            <div class="intro-dot"></div>
            <div class="intro-dot"></div>
          </div>
          
          <div class="intro-nav">
            <button class="btn-secondary" onclick="goToScreen('landing')">Back</button>
            <button class="btn-primary" onclick="goToScreen('intro2')">Next</button>
          </div>
        </div>
      </div>
      
      <div class="screen" id="screenIntro2">
        <div class="intro">
          <div class="intro-content">
            <div class="intro-icon">
              <svg viewBox="0 0 24 24"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
            </div>
            <div class="intro-number">The solution</div>
            <h2 class="intro-title">We diagnose. You decide.</h2>
            <p class="intro-desc">Paste your message. We identify why it's misfiring and recommend the best-fit technique from 58 proven approaches.</p>
          </div>
          
          <div class="intro-dots">
            <div class="intro-dot"></div>
            <div class="intro-dot active"></div>
            <div class="intro-dot"></div>
          </div>
          
          <div class="intro-nav">
            <button class="btn-secondary" onclick="goToScreen('intro1')">Back</button>
            <button class="btn-primary" onclick="goToScreen('intro3')">Next</button>
          </div>
        </div>
      </div>
      
      <div class="screen" id="screenIntro3">
        <div class="intro">
          <div class="intro-content">
            <div class="intro-icon-row">
              <div class="intro-icon-small">
                <svg viewBox="0 0 24 24"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>
              </div>
              <div class="intro-icon-small">
                <svg viewBox="0 0 24 24"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></svg>
              </div>
            </div>
            <div class="intro-number">Two modes</div>
            <h2 class="intro-title">Fix a message or build the skill</h2>
            <p class="intro-desc"><strong>Diagnose:</strong> Get reframes for a stuck message.<br><strong>Learn:</strong> Explore the 58 techniques.</p>
          </div>
          
          <div class="intro-dots">
            <div class="intro-dot"></div>
            <div class="intro-dot"></div>
            <div class="intro-dot active"></div>
          </div>
          
          <div class="intro-nav">
            <button class="btn-secondary" onclick="goToScreen('intro2')">Back</button>
            <button class="btn-primary" onclick="goToScreen(0)">Let's go →</button>
          </div>
        </div>
      </div>
      
      <!-- ========== MAIN APP ========== -->
      
      <!-- Screen 0: Mode Selection -->
      <div class="screen" id="screen0">
        <h1>How can I help?</h1>
        <p class="subtitle">Choose your path.</p>
        
        <div class="mode-selector">
          <div class="mode-card selected" id="modeDiagnose" onclick="selectMode('diagnose')">
            <div class="mode-icon">
              <svg viewBox="0 0 24 24"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
            </div>
            <div class="mode-title">Diagnose</div>
            <div class="mode-desc">Fix a stuck message</div>
          </div>
          <div class="mode-card" id="modeLearn" onclick="selectMode('learn')">
            <div class="mode-icon">
              <svg viewBox="0 0 24 24"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></svg>
            </div>
            <div class="mode-title">Learn</div>
            <div class="mode-desc">Explore techniques</div>
          </div>
        </div>
        
        <button class="btn-primary" onclick="startMode()">Continue →</button>
      </div>
      
      <!-- Screen 1: Intake -->
      <div class="screen" id="screen1">
        <h1>What's not landing?</h1>
        <p class="subtitle">Paste the message that isn't working.</p>
        
        <div class="form-group">
          <textarea id="messageInput" placeholder="e.g., 'You need to update your process to stay compliant with new regulations...'"></textarea>
        </div>
        
        <div class="form-group">
          <label>Who's it for? <span>(optional)</span></label>
          <input type="text" id="audienceInput" placeholder="e.g., 'Operations managers at mid-size companies'">
        </div>
        
        <div class="form-group">
          <label>What happens when they hear it?</label>
          <div class="reaction-grid">
            <button class="reaction-btn" data-reaction="confusion" data-cause="confusion">
              <div class="reaction-icon">
                <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>
              </div>
              <span>They don't get it</span>
            </button>
            <button class="reaction-btn" data-reaction="fear" data-cause="fear_risk">
              <div class="reaction-icon">
                <svg viewBox="0 0 24 24"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"/><line x1="12" y1="9" x2="12" y2="13"/><line x1="12" y1="17" x2="12.01" y2="17"/></svg>
              </div>
              <span>They seem worried</span>
            </button>
            <button class="reaction-btn" data-reaction="pushback" data-cause="fairness_blame">
              <div class="reaction-icon">
                <svg viewBox="0 0 24 24"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
              </div>
              <span>They push back</span>
            </button>
            <button class="reaction-btn" data-reaction="defensive" data-cause="identity_threat">
              <div class="reaction-icon">
                <svg viewBox="0 0 24 24"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
              </div>
              <span>They get defensive</span>
            </button>
            <button class="reaction-btn" data-reaction="ignore" data-cause="low_motivation">
              <div class="reaction-icon">
                <svg viewBox="0 0 24 24"><path d="M17 18a5 5 0 0 0-10 0"/><line x1="12" y1="2" x2="12" y2="9"/><line x1="4.22" y1="10.22" x2="5.64" y2="11.64"/><line x1="1" y1="18" x2="3" y2="18"/><line x1="21" y1="18" x2="23" y2="18"/><line x1="18.36" y1="11.64" x2="19.78" y2="10.22"/><line x1="23" y1="22" x2="1" y2="22"/><polyline points="8 6 12 2 16 6"/></svg>
              </div>
              <span>They ignore it</span>
            </button>
            <button class="reaction-btn" data-reaction="mismatch" data-cause="narrative_mismatch">
              <div class="reaction-icon">
                <svg viewBox="0 0 24 24"><line x1="4" y1="21" x2="4" y2="14"/><line x1="4" y1="10" x2="4" y2="3"/><line x1="12" y1="21" x2="12" y2="12"/><line x1="12" y1="8" x2="12" y2="3"/><line x1="20" y1="21" x2="20" y2="16"/><line x1="20" y1="12" x2="20" y2="3"/><line x1="1" y1="14" x2="7" y2="14"/><line x1="9" y1="8" x2="15" y2="8"/><line x1="17" y1="16" x2="23" y2="16"/></svg>
              </div>
              <span>It doesn't land</span>
            </button>
          </div>
        </div>
        
        <button class="btn-primary" id="btnAnalyze" disabled onclick="analyzeMessage()">Analyze →</button>
      </div>
      
      <!-- Screen 1b: Analyzing -->
      <div class="screen" id="screen1b">
        <div class="testing-container">
          <div class="testing-spinner"></div>
          <p class="testing-title">Analyzing your message</p>
          <p class="testing-subtitle">Finding the root cause...</p>
        </div>
      </div>
      
      <!-- Screen 2: Diagnosis -->
      <div class="screen" id="screen2">
        <h1>Here's what I'm seeing</h1>
        
        <div class="card card-default">
          <div class="card-label">Root Cause</div>
          <p id="diagnosisRootCause">Loading...</p>
        </div>
        
        <div class="card card-highlight">
          <div class="card-label">The Unlock</div>
          <p id="diagnosisInsight">Loading...</p>
        </div>
        
        <div class="card card-default">
          <div class="card-label">Your Message</div>
          <p class="muted" id="echoMessage">"..."</p>
        </div>
        
        <div class="btn-row">
          <button class="btn-secondary" onclick="goToScreen(1)">←</button>
          <button class="btn-primary" onclick="goToScreen(3)">Show techniques →</button>
        </div>
      </div>
      
      <!-- Screen 3: Technique Selection -->
      <div class="screen" id="screen3">
        <h1>Recommended Techniques</h1>
        <p class="subtitle">Ranked by fit score.</p>
        
        <div id="techniqueCards"></div>
        
        <button class="btn-ghost" onclick="goToScreen('3b')">
          <svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="16"/><line x1="8" y1="12" x2="16" y2="12"/></svg>
          Browse all 58 techniques
        </button>
        
        <button class="btn-text" onclick="goToScreen(2)">← Back to diagnosis</button>
      </div>
      
      <!-- Screen 3b: Technique Browser -->
      <div class="screen" id="screen3b">
        <h1>All Techniques</h1>
        <p class="subtitle">58 techniques across 9 families.</p>
        
        <div id="familyList"></div>
        
        <button class="btn-text" onclick="goToScreen(3)">← Back to recommended</button>
      </div>
      
      <!-- Screen 3c: Family Detail -->
      <div class="screen" id="screen3c">
        <h2 id="familyDetailTitle">Family Name</h2>
        
        <div id="familyTechList"></div>
        
        <button class="btn-text" onclick="goToScreen('3b')">← Back to families</button>
      </div>
      
      <!-- Screen 4: Reframe Generation -->
      <div class="screen" id="screen4">
        <h1>Generate reframes</h1>
        <p class="subtitle">Using the recommended technique.</p>
        
        <!-- Technique (Primary) -->
        <div class="technique-primary">
          <div class="technique-primary-header">
            <div>
              <div class="technique-primary-label">Technique</div>
              <div class="technique-primary-name" id="primaryTechniqueName">Identity Invitation</div>
            </div>
            <div class="technique-primary-score">
              <div class="score-value" id="primaryTechniqueScore">87%</div>
              <div class="score-label">Fit</div>
            </div>
          </div>
          <p class="technique-primary-desc" id="primaryTechniqueDesc">Invite the audience into a positive identity that matches the desired behavior.</p>
          <button class="btn-change-technique" onclick="goToScreen(3)">Change technique</button>
        </div>
        
        <!-- Optional Styling -->
        <div class="styling-section">
          <div class="styling-header">
            <span class="styling-title">Style options</span>
            <span class="styling-optional">optional</span>
          </div>
          
          <!-- Voice -->
          <div class="styling-row">
            <div class="styling-row-label">Voice</div>
            <div class="styling-pills">
              <button class="styling-pill active" data-type="voice" data-value="auto" onclick="selectStyling('voice', 'auto', this)">You choose</button>
              <button class="styling-pill" data-type="voice" data-value="peer" onclick="selectStyling('voice', 'peer', this)">Peer</button>
              <button class="styling-pill" data-type="voice" data-value="expert" onclick="selectStyling('voice', 'expert', this)">Expert</button>
              <button class="styling-pill" data-type="voice" data-value="brand" onclick="selectStyling('voice', 'brand', this)">Brand</button>
            </div>
          </div>
          
          <!-- Vehicle -->
          <div class="styling-row">
            <div class="styling-row-label">Format</div>
            <div class="styling-pills">
              <button class="styling-pill active" data-type="vehicle" data-value="auto" onclick="selectStyling('vehicle', 'auto', this)">You choose</button>
              <button class="styling-pill" data-type="vehicle" data-value="story" onclick="selectStyling('vehicle', 'story', this)">Story</button>
              <button class="styling-pill" data-type="vehicle" data-value="statistic" onclick="selectStyling('vehicle', 'statistic', this)">Stat</button>
              <button class="styling-pill" data-type="vehicle" data-value="question" onclick="selectStyling('vehicle', 'question', this)">Question</button>
              <button class="styling-pill" data-type="vehicle" data-value="analogy" onclick="selectStyling('vehicle', 'analogy', this)">Analogy</button>
            </div>
          </div>
        </div>
        
        <button class="btn-primary" onclick="generateReframes()">Generate reframes →</button>
        <button class="btn-text" onclick="goToScreen(3)">← Back to techniques</button>
      </div>
      
      <!-- Screen 4b: Reframe Selection -->
      <div class="screen" id="screen4b">
        <h1>Pick at least two</h1>
        <p class="subtitle">A/B testing needs options to compare.</p>
        
        <div class="mb-16">
          <span class="badge dark" id="resultTechniqueBadge">Identity Invitation</span>
        </div>
        
        <div class="selection-count">
          <strong id="selectionCount">0</strong> selected <span class="selection-minimum">(min 2 for testing)</span>
        </div>
        
        <div id="reframeOptions"></div>
        
        <button class="btn-ghost" onclick="regenerateReframes()">
          <svg viewBox="0 0 24 24"><path d="M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8"/><path d="M21 3v5h-5"/></svg>
          Generate more
        </button>
        
        <button class="btn-primary" id="btnTest" disabled onclick="runTest()">Test these →</button>
        <button class="btn-text" onclick="goToScreen(4)">← Change style options</button>
      </div>
      
      <!-- Screen 4c: Testing -->
      <div class="screen" id="screen4c">
        <div class="testing-container">
          <div class="testing-spinner"></div>
          <p class="testing-title">Testing with synthetic audience</p>
          <p class="testing-subtitle" id="testingAudience">Operations managers</p>
          
          <div class="testing-items" id="testingItems"></div>
        </div>
      </div>
      
      <!-- Screen 5: Results -->
      <div class="screen" id="screen5">
        <div class="results-header">
          <h1>Results</h1>
          <p class="results-audience">Tested against: <span id="resultsAudience">Operations managers</span></p>
        </div>
        
        <div id="resultCards"></div>
        
        <div class="btn-row">
          <button class="btn-outline" onclick="goToScreen('4b')">Try new ones</button>
          <button class="btn-primary" onclick="useWinner()">Use winner →</button>
        </div>
      </div>
      
      <!-- Screen 6: Final -->
      <div class="screen" id="screen6">
        <div class="success-header">
          <div class="success-icon">
            <svg viewBox="0 0 24 24"><polyline points="20 6 9 17 4 12"/></svg>
          </div>
          <h1>Your New Frame</h1>
        </div>
        
        <div class="final-reframe">
          <p id="finalReframe">"..."</p>
        </div>
        
        <div class="summary-card">
          <div class="summary-row">
            <span class="summary-label">Root Cause</span>
            <span class="summary-value" id="summaryRootCause">Identity Threat</span>
          </div>
          <div class="summary-row">
            <span class="summary-label">Technique</span>
            <span class="summary-value" id="summaryTechnique">Identity Invitation</span>
          </div>
          <div class="summary-row">
            <span class="summary-label">Angle</span>
            <span class="summary-value" id="summaryAngle">Social Proof</span>
          </div>
          <div class="summary-row">
            <span class="summary-label">Test Score</span>
            <span class="summary-value" id="summaryScore">84%</span>
          </div>
        </div>
        
        <div class="action-grid">
          <button class="action-btn">
            <svg viewBox="0 0 24 24"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>
            Copy
          </button>
          <button class="action-btn">
            <svg viewBox="0 0 24 24"><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/><polyline points="17 21 17 13 7 13 7 21"/><polyline points="7 3 7 8 15 8"/></svg>
            Save
          </button>
          <button class="action-btn">
            <svg viewBox="0 0 24 24"><circle cx="18" cy="5" r="3"/><circle cx="6" cy="12" r="3"/><circle cx="18" cy="19" r="3"/><line x1="8.59" y1="13.51" x2="15.42" y2="17.49"/><line x1="15.41" y1="6.51" x2="8.59" y2="10.49"/></svg>
            Share
          </button>
        </div>
        
        <button class="btn-primary" onclick="resetApp()">Start new diagnosis</button>
        <button class="btn-text" onclick="goToScreen(7)">Learn more about this technique →</button>
      </div>
      
      <!-- ========== LEARNING MODE ========== -->
      
      <!-- Screen 7: Learn Home -->
      <div class="screen" id="screen7">
        <h1>Learn</h1>
        <p class="subtitle">Master the 58 techniques.</p>
        
        <div class="learn-nav">
          <button class="learn-nav-btn active" onclick="setLearnTab('browse', this)">Browse</button>
          <button class="learn-nav-btn" onclick="setLearnTab('flashcards', this)">Flashcards</button>
          <button class="learn-nav-btn" onclick="setLearnTab('cases', this)">Case Studies</button>
        </div>
        
        <div id="learnBrowse">
          <div id="learnFamilyList"></div>
        </div>
        
        <div id="learnFlashcards" style="display:none;">
          <div class="flashcard-container">
            <div class="flashcard" id="flashcard" onclick="flipCard()">
              <div class="flashcard-face flashcard-front">
                <div class="flashcard-label">When to use</div>
                <div class="flashcard-title" id="flashcardTitle">Valence Switching</div>
                <div class="flashcard-family" id="flashcardFamily">Wording & Labeling</div>
                <div class="flashcard-content" id="flashcardWhen">Use when wording feels harsh, negative, or stigmatizing.</div>
                <div class="flashcard-hint">Tap to see definition</div>
              </div>
              <div class="flashcard-face flashcard-back">
                <div class="flashcard-label">Definition</div>
                <div class="flashcard-title" id="flashcardTitleBack">Valence Switching</div>
                <div class="flashcard-content" id="flashcardDef">Swap negative wording for neutral or positive wording while preserving the underlying reality.</div>
                <div class="flashcard-hint">Tap to flip back</div>
              </div>
            </div>
          </div>
          
          <div class="flashcard-nav">
            <button class="flashcard-nav-btn" onclick="prevCard()">
              <svg viewBox="0 0 24 24"><polyline points="15 18 9 12 15 6"/></svg>
            </button>
            <div class="flashcard-progress">
              <strong id="cardIndex">1</strong> of <span id="cardTotal">58</span>
            </div>
            <button class="flashcard-nav-btn" onclick="nextCard()">
              <svg viewBox="0 0 24 24"><polyline points="9 18 15 12 9 6"/></svg>
            </button>
          </div>
        </div>
        
        <div id="learnCases" style="display:none;">
          <div class="case-card">
            <div class="case-header">
              <div class="case-industry">Healthcare</div>
              <div class="case-title">Reducing patient no-shows</div>
            </div>
            <div class="case-body">
              <div class="case-before-after">
                <div class="case-column">
                  <div class="case-column-label">Before</div>
                  <div class="case-column-text">"Missing appointments costs us $200 per slot."</div>
                </div>
                <div class="case-column">
                  <div class="case-column-label">After</div>
                  <div class="case-column-text">"We've reserved this time just for you."</div>
                </div>
              </div>
              <div class="case-technique">
                <span class="case-technique-label">Technique: </span>
                <span class="case-technique-name">Identity Invitation</span>
              </div>
            </div>
          </div>
          
          <div class="case-card">
            <div class="case-header">
              <div class="case-industry">SaaS</div>
              <div class="case-title">Increasing trial conversions</div>
            </div>
            <div class="case-body">
              <div class="case-before-after">
                <div class="case-column">
                  <div class="case-column-label">Before</div>
                  <div class="case-column-text">"Your trial expires in 3 days."</div>
                </div>
                <div class="case-column">
                  <div class="case-column-label">After</div>
                  <div class="case-column-text">"You're 80% through setup. Finish to keep your work."</div>
                </div>
              </div>
              <div class="case-technique">
                <span class="case-technique-label">Technique: </span>
                <span class="case-technique-name">Relative Progress</span>
              </div>
            </div>
          </div>
          
          <div class="case-card">
            <div class="case-header">
              <div class="case-industry">Finance</div>
              <div class="case-title">Explaining fee structures</div>
            </div>
            <div class="case-body">
              <div class="case-before-after">
                <div class="case-column">
                  <div class="case-column-label">Before</div>
                  <div class="case-column-text">"There's a 2.5% annual fee."</div>
                </div>
                <div class="case-column">
                  <div class="case-column-label">After</div>
                  <div class="case-column-text">"For every $100, $2.50 goes to management."</div>
                </div>
              </div>
              <div class="case-technique">
                <span class="case-technique-label">Technique: </span>
                <span class="case-technique-name">Everyday Units</span>
              </div>
            </div>
          </div>
        </div>
        
        <button class="btn-primary mt-16" onclick="goToScreen(0)">← Back to start</button>
      </div>
      
      <!-- Screen 7b: Family Detail (Learn) -->
      <div class="screen" id="screen7b">
        <h2 id="learnFamilyTitle">Family Name</h2>
        
        <div id="learnTechList"></div>
        
        <button class="btn-text" onclick="goToScreen(7)">← Back to learn</button>
      </div>
      
      <!-- Screen 7c: Technique Detail (Learn) -->
      <div class="screen" id="screen7c">
        <div class="mb-16">
          <span class="badge" id="techDetailFamily">Family</span>
        </div>
        
        <h2 id="techDetailName">Technique Name</h2>
        
        <div class="card card-default">
          <div class="card-label">When to use</div>
          <p id="techDetailWhen">...</p>
        </div>
        
        <div class="card card-highlight">
          <div class="card-label">Definition</div>
          <p id="techDetailDef">...</p>
        </div>
        
        <button class="btn-primary" onclick="useTechniqueFromLearn()">Use this technique →</button>
        <button class="btn-text" onclick="goToScreen('7b')">← Back to family</button>
      </div>
      
    </div>
  </div>

  <script>
    // State
    let currentScreen = 'landing';
    let selectedMode = 'diagnose';
    let selectedReaction = null;
    let selectedRootCause = null;
    let selectedTechnique = null;
    let selectedReframes = [];
    let allReframes = [];
    let generatedCount = 0;
    let testResults = [];
    let winnerReframe = null;
    let currentLearnTab = 'browse';
    let currentCardIndex = 0;
    let currentFamilyId = null;
    let currentTechDetail = null;
    
    const families = [
      { id: 'wl', name: 'Wording & Labeling', count: 9 },
      { id: 'qs', name: 'Quantity & Scale', count: 8 },
      { id: 'cc', name: 'Contrast & Comparison', count: 7 },
      { id: 'cr', name: 'Causality & Responsibility', count: 7 },
      { id: 'is', name: 'Identity & Social Norms', count: 7 },
      { id: 'ns', name: 'Narrative Structure', count: 8 },
      { id: 'mc', name: 'Metaphor & Conceptual Frame', count: 8 },
      { id: 'tu', name: 'Time & Uncertainty', count: 4 }
    ];
    
    const allTechniques = [
      { id: 'WL01', name: 'Valence Switching', family: 'Wording & Labeling', familyId: 'wl', when: 'Use when wording feels harsh, negative, or stigmatizing.', def: 'Swap negative wording for neutral or positive wording while preserving the underlying reality.' },
      { id: 'WL02', name: 'Polarity Inversion', family: 'Wording & Labeling', familyId: 'wl', when: 'Use when the same outcome can be truthfully framed as either a gain or a loss.', def: 'Re-express a loss as a gain or vice versa to shift perception.' },
      { id: 'WL06', name: 'Plain Language Translation', family: 'Wording & Labeling', familyId: 'wl', when: 'Use when jargon or complexity is confusing the audience.', def: 'Replace technical or abstract language with simple everyday wording.' },
      { id: 'QS05', name: 'Everyday Units', family: 'Quantity & Scale', familyId: 'qs', when: 'Use when units are unfamiliar or abstract.', def: 'Translate measurements into relatable everyday equivalents.' },
      { id: 'CC07', name: 'Relative Progress', family: 'Contrast & Comparison', familyId: 'cc', when: 'Use when people feel stuck or unmotivated.', def: 'Show how close they are to a goal or how much progress they have already made.' },
      { id: 'IS01', name: 'Identity Invitation', family: 'Identity & Social Norms', familyId: 'is', when: 'Use when the behavior aligns with a desirable identity.', def: 'Invite the audience into a positive identity that matches the behavior.' },
      { id: 'NS04', name: 'Plot Arc', family: 'Narrative Structure', familyId: 'ns', when: 'Use when the experience feels flat or static.', def: 'Show how the audience moves from one state to a better state.' },
      { id: 'TU03', name: 'Certainty Emphasis', family: 'Time & Uncertainty', familyId: 'tu', when: 'Use when people feel everything is uncertain.', def: 'Clarify what is fixed and predictable.' }
    ];
    
    const rootCauses = {
      confusion: { label: "Confusion", diagnosis: "The message is too abstract or jargon-heavy.", insight: "Translate abstract concepts into concrete, everyday language." },
      fear_risk: { label: "Fear / Risk", diagnosis: "The message emphasizes what could go wrong.", insight: "Reframe to emphasize safety, certainty, or what they preserve." },
      fairness_blame: { label: "Fairness / Blame", diagnosis: "The message implies fault or unfairness.", insight: "Shift responsibility to the system or shared circumstances." },
      identity_threat: { label: "Identity Threat", diagnosis: "The message implies the audience is doing something wrong.", insight: "Position them as smart early adopters, not late correctors." },
      low_motivation: { label: "Low Motivation", diagnosis: "The message doesn't connect to what they care about.", insight: "Connect the ask to their existing goals, values, or identity." },
      narrative_mismatch: { label: "Narrative Mismatch", diagnosis: "The audience doesn't see themselves in the story.", insight: "Make sure they're the hero." }
    };
    
    const techniques = {
      identity_threat: [
        { id: "IS01", name: "Identity Invitation", family: "Identity & Social Norms", score: 87, description: "Invite the audience into a positive identity.", example: "Join the growing number of forward-thinking teams...", reframes: [
          { axis: "Social Proof", text: "Join the growing number of teams who've already made the switch.", vehicle: 'story', voice: 'peer' },
          { axis: "Aspiration", text: "Forward-thinking managers are discovering a faster way to stay aligned.", vehicle: 'story', voice: 'brand' },
          { axis: "Validation", text: "The smartest teams we work with started asking the same question.", vehicle: 'story', voice: 'expert' },
          { axis: "Evolution", text: "You've built a solid foundation. Here's how leading teams are taking it further.", vehicle: 'story', voice: 'peer' }
        ]},
        { id: "NS04", name: "Plot Arc", family: "Narrative Structure", score: 71, description: "Frame the change as natural evolution.", example: "You've built a solid foundation. Here's how to take it further...", reframes: [
          { axis: "Progress", text: "You've come a long way. This is the next step.", vehicle: 'story', voice: 'brand' },
          { axis: "Opportunity", text: "What worked yesterday still works — but now there's something better.", vehicle: 'story', voice: 'brand' },
          { axis: "Timing", text: "The foundation is set. Now is the right time to build on it.", vehicle: 'story', voice: 'brand' },
          { axis: "Growth", text: "This isn't about fixing what's broken. It's about unlocking what's next.", vehicle: 'story', voice: 'brand' }
        ]}
      ],
      confusion: [
        { id: "WL06", name: "Plain Language Translation", family: "Wording & Labeling", score: 84, description: "Replace jargon with simple everyday wording.", example: "Instead of 'optimize your workflow,' say 'get more done in less time.'", reframes: [
          { axis: "Everyday Words", text: "Get more done in less time — without adding more meetings.", vehicle: 'statistic', voice: 'brand' },
          { axis: "Concrete Action", text: "See all your projects in one place. Update them with one click.", vehicle: 'story', voice: 'brand' },
          { axis: "Familiar Comparison", text: "Think of it like a shared to-do list that updates itself.", vehicle: 'analogy', voice: 'brand' },
          { axis: "Benefit First", text: "Less time hunting for information. More time doing the actual work.", vehicle: 'statistic', voice: 'brand' }
        ]},
        { id: "QS05", name: "Everyday Units", family: "Quantity & Scale", score: 68, description: "Translate abstract measurements into relatable equivalents.", example: "That's about the time it takes to make a cup of coffee.", reframes: [
          { axis: "Time Familiar", text: "Takes about as long as making a cup of coffee.", vehicle: 'analogy', voice: 'brand' },
          { axis: "Money Tangible", text: "Costs less than your monthly streaming subscription.", vehicle: 'analogy', voice: 'brand' },
          { axis: "Size Relatable", text: "About the size of a deck of cards.", vehicle: 'analogy', voice: 'brand' },
          { axis: "Frequency Clear", text: "Once a week — less often than you check your email.", vehicle: 'analogy', voice: 'brand' }
        ]}
      ]
    };
    
    const additionalReframes = {
      'Identity Invitation': [
        { axis: "Peer Momentum", text: "Your peers are already seeing results. Here's how to catch up — fast.", isNew: true, vehicle: 'story', voice: 'peer' },
        { axis: "Insider Status", text: "Early adopters are getting exclusive access. Join them.", isNew: true, vehicle: 'story', voice: 'brand' }
      ],
      'Plain Language Translation': [
        { axis: "One Sentence", text: "In short: less hassle, same results.", isNew: true, vehicle: 'statistic', voice: 'brand' },
        { axis: "Kid Test", text: "If you had to explain it to a 10-year-old: it just works better.", isNew: true, vehicle: 'analogy', voice: 'brand' }
      ]
    };
    
    // Matrix-generated reframes by style combination
    const matrixReframes = {
      'Identity Invitation': {
        'story-peer-social': { axis: "Peer Story", text: "Teams like yours made the switch last quarter. Now they're the ones others ask for advice.", vehicle: 'story', voice: 'peer' },
        'statistic-expert-logic': { axis: "Expert Data", text: "McKinsey found early adopters are perceived as 40% more innovative by their peers.", vehicle: 'statistic', voice: 'expert' },
        'question-brand-identity': { axis: "Reflective Question", text: "If you knew it would work, would you want to be first or last?", vehicle: 'question', voice: 'brand' },
        'analogy-brand-emotion': { axis: "Brand Analogy", text: "Think of it like upgrading from a flip phone—not because yours is broken, but because you're ready.", vehicle: 'analogy', voice: 'brand' },
        'story-brand-identity': { axis: "Future Vision", text: "A year from now, you'll either be the one who moved early—or the one still catching up.", vehicle: 'story', voice: 'brand' },
        'statistic-peer-social': { axis: "Peer Numbers", text: "73% of teams in your industry have already started this transition.", vehicle: 'statistic', voice: 'peer' },
        'question-expert-logic': { axis: "Expert Challenge", text: "The research is clear on the benefits—what's the real hesitation?", vehicle: 'question', voice: 'expert' },
        'analogy-peer-social': { axis: "Peer Analogy", text: "It's like when your whole team switched to Slack. You don't want to be the last one on email.", vehicle: 'analogy', voice: 'peer' },
        'story-expert-logic': { axis: "Case Study", text: "When Stripe adopted this approach, their team velocity doubled within two quarters.", vehicle: 'story', voice: 'expert' },
        'statistic-brand-identity': { axis: "Progress Stat", text: "You're already ahead of 60% of companies. This puts you in the top 10%.", vehicle: 'statistic', voice: 'brand' },
        'question-peer-social': { axis: "Peer Question", text: "Your competitors are already asking this question. Are you?", vehicle: 'question', voice: 'peer' },
        'analogy-expert-logic': { axis: "Expert Analogy", text: "Researchers compare it to compound interest—small early moves yield outsized returns.", vehicle: 'analogy', voice: 'expert' }
      }
    };
    
    // Style state - simpler
    let selectedVoice = 'auto';
    let selectedVehicle = 'auto';
    
    function selectStyling(type, value, element) {
      // Update state
      if (type === 'voice') selectedVoice = value;
      if (type === 'vehicle') selectedVehicle = value;
      
      // Update UI - deselect siblings, select this
      element.parentElement.querySelectorAll('.styling-pill').forEach(p => p.classList.remove('active'));
      element.classList.add('active');
    }
    
    function generateReframes() {
      allReframes = [];
      selectedReframes = [];
      
      const baseReframes = selectedTechnique.reframes || [];
      const techMatrix = matrixReframes[selectedTechnique.name] || {};
      
      // Build full pool from base + matrix
      let fullPool = [...baseReframes];
      for (const [key, reframe] of Object.entries(techMatrix)) {
        const exists = fullPool.some(r => r.text === reframe.text);
        if (!exists) fullPool.push(reframe);
      }
      
      // Separate into matching and non-matching
      let matching = [];
      let nonMatching = [];
      
      fullPool.forEach(r => {
        const voiceMatch = selectedVoice === 'auto' || r.voice === selectedVoice;
        const vehicleMatch = selectedVehicle === 'auto' || r.vehicle === selectedVehicle;
        
        if (voiceMatch && vehicleMatch) {
          matching.push(r);
        } else {
          nonMatching.push(r);
        }
      });
      
      // Prioritize matching, then fill with non-matching to get 4-6
      allReframes = [...matching];
      
      // If we need more, add from non-matching
      const minReframes = 4;
      if (allReframes.length < minReframes) {
        const needed = minReframes - allReframes.length;
        allReframes = [...allReframes, ...nonMatching.slice(0, needed)];
      }
      
      // Cap at 6
      allReframes = allReframes.slice(0, 6);
      
      document.getElementById('resultTechniqueBadge').textContent = selectedTechnique.name;
      buildReframeOptions();
      updateSelectionCount();
      goToScreen('4b');
    }
    
    function regenerateReframes() {
      // Add more from matrix if available
      const techMatrix = matrixReframes[selectedTechnique.name] || {};
      let added = 0;
      
      for (const [key, reframe] of Object.entries(techMatrix)) {
        const exists = allReframes.some(r => r.text === reframe.text);
        if (!exists) {
          allReframes.push({ ...reframe, isNew: true });
          added++;
          if (added >= 2) break;
        }
      }
      
      if (added === 0) {
        alert('No more variations available.');
      } else {
        buildReframeOptions();
      }
    }
    
    // Initialize
    document.getElementById('messageInput').addEventListener('input', function() {
      document.getElementById('btnAnalyze').disabled = !this.value.trim();
    });
    
    document.querySelectorAll('.reaction-btn').forEach(btn => {
      btn.addEventListener('click', function() {
        document.querySelectorAll('.reaction-btn').forEach(b => b.classList.remove('selected'));
        this.classList.add('selected');
        selectedReaction = this.dataset.reaction;
        selectedRootCause = this.dataset.cause;
      });
    });
    
    function selectMode(mode) {
      selectedMode = mode;
      document.getElementById('modeDiagnose').classList.toggle('selected', mode === 'diagnose');
      document.getElementById('modeLearn').classList.toggle('selected', mode === 'learn');
    }
    
    function startMode() {
      if (selectedMode === 'learn') {
        buildLearnFamilyList();
        goToScreen(7);
      } else {
        goToScreen(1);
      }
    }
    
    function analyzeMessage() {
      goToScreen('1b');
      setTimeout(() => {
        const cause = selectedRootCause || 'identity_threat';
        const causeData = rootCauses[cause];
        document.getElementById('diagnosisRootCause').textContent = causeData.diagnosis;
        document.getElementById('diagnosisInsight').textContent = causeData.insight;
        document.getElementById('echoMessage').textContent = '"' + document.getElementById('messageInput').value + '"';
        buildTechniqueCards(cause);
        goToScreen(2);
      }, 1500);
    }
    
    function buildTechniqueCards(cause) {
      const techList = techniques[cause] || techniques['identity_threat'];
      const container = document.getElementById('techniqueCards');
      container.innerHTML = '';
      
      techList.forEach((tech, index) => {
        const card = document.createElement('button');
        card.className = 'technique-card' + (index === 0 ? ' recommended' : '');
        card.onclick = () => selectTechnique(tech, cause);
        card.innerHTML = `
          <div class="technique-header">
            <div>
              <div class="technique-meta">${tech.family}</div>
              <div class="technique-name">${tech.name}</div>
            </div>
            <div class="technique-score">
              <div class="score-value">${tech.score}%</div>
              <div class="score-label">Fit</div>
            </div>
          </div>
          <p class="technique-desc">${tech.description}</p>
          <div class="technique-example">${tech.example}</div>
          <div class="badge-row">
            ${index === 0 ? '<span class="badge dark">Recommended</span>' : ''}
            <span class="badge">Low risk</span>
          </div>
        `;
        container.appendChild(card);
      });
    }
    
    function buildLearnFamilyList() {
      const container = document.getElementById('learnFamilyList');
      container.innerHTML = '';
      families.forEach(f => {
        const card = document.createElement('div');
        card.className = 'family-card';
        card.onclick = () => showLearnFamily(f);
        card.innerHTML = `
          <div class="family-info">
            <div class="family-name">${f.name}</div>
            <div class="family-count">${f.count} techniques</div>
          </div>
          <svg class="family-arrow" viewBox="0 0 24 24"><polyline points="9 18 15 12 9 6"/></svg>
        `;
        container.appendChild(card);
      });
    }
    
    function showLearnFamily(family) {
      currentFamilyId = family.id;
      document.getElementById('learnFamilyTitle').textContent = family.name;
      const container = document.getElementById('learnTechList');
      container.innerHTML = '';
      const techs = allTechniques.filter(t => t.familyId === family.id);
      techs.forEach(t => {
        const item = document.createElement('div');
        item.className = 'tech-list-item';
        item.onclick = () => showTechDetail(t);
        item.innerHTML = `
          <div class="tech-list-name">${t.name}</div>
          <div class="tech-list-desc">${t.when}</div>
        `;
        container.appendChild(item);
      });
      goToScreen('7b');
    }
    
    function showTechDetail(tech) {
      currentTechDetail = tech;
      document.getElementById('techDetailFamily').textContent = tech.family;
      document.getElementById('techDetailName').textContent = tech.name;
      document.getElementById('techDetailWhen').textContent = tech.when;
      document.getElementById('techDetailDef').textContent = tech.def;
      goToScreen('7c');
    }
    
    function useTechniqueFromLearn() {
      alert('This would take you to Diagnose mode with ' + currentTechDetail.name + ' pre-selected.');
    }
    
    function selectTechnique(tech, cause) {
      selectedTechnique = tech;
      selectedReframes = [];
      selectedVoice = 'auto';
      selectedVehicle = 'auto';
      allReframes = [];
      
      // Reset styling pills to "You choose"
      document.querySelectorAll('.styling-pill').forEach(p => {
        p.classList.toggle('active', p.dataset.value === 'auto');
      });
      
      // Populate primary technique card
      document.getElementById('primaryTechniqueName').textContent = tech.name;
      document.getElementById('primaryTechniqueScore').textContent = tech.score + '%';
      document.getElementById('primaryTechniqueDesc').textContent = tech.description;
      
      goToScreen(4);
    }
    
    function buildReframeOptions() {
      const container = document.getElementById('reframeOptions');
      container.innerHTML = '';
      
      allReframes.forEach((item, index) => {
        const option = document.createElement('button');
        option.className = 'reframe-option' + (selectedReframes.find(r => r.index === index) ? ' selected' : '');
        option.dataset.index = index;
        option.onclick = () => toggleReframe(index, item, option);
        
        // Simple label based on axis or generate one
        const label = item.axis || `Option ${index + 1}`;
        
        option.innerHTML = `
          <div class="reframe-checkbox">
            <svg viewBox="0 0 24 24"><polyline points="20 6 9 17 4 12"/></svg>
          </div>
          <div class="reframe-label">${label}${item.isNew ? ' · NEW' : ''}</div>
          <div class="reframe-text">${item.text}</div>
        `;
        container.appendChild(option);
      });
    }
    
    function toggleReframe(index, item, element) {
      const existingIndex = selectedReframes.findIndex(r => r.index === index);
      if (existingIndex > -1) {
        selectedReframes.splice(existingIndex, 1);
        element.classList.remove('selected');
      } else {
        selectedReframes.push({ index, ...item });
        element.classList.add('selected');
      }
      updateSelectionCount();
    }
    
    function updateSelectionCount() {
      document.getElementById('selectionCount').textContent = selectedReframes.length;
      // Need at least 2 for A/B testing
      document.getElementById('btnTest').disabled = selectedReframes.length < 2;
    }
    
    function generateMoreReframes() {
      const additional = additionalReframes[selectedTechnique.name] || [];
      const toAdd = additional.slice(generatedCount, generatedCount + 2);
      if (toAdd.length === 0) {
        alert('No more variations available for this technique.');
        return;
      }
      toAdd.forEach(r => allReframes.push(r));
      generatedCount += toAdd.length;
      buildReframeOptions();
    }
    
    function runTest() {
      const audience = document.getElementById('audienceInput').value || 'General audience';
      document.getElementById('testingAudience').textContent = audience;
      document.getElementById('resultsAudience').textContent = audience;
      
      const testingItems = document.getElementById('testingItems');
      testingItems.innerHTML = selectedReframes.map((r, i) => `
        <div class="testing-item" id="testItem${i}">
          <div class="testing-item-icon"><svg viewBox="0 0 24 24"><polyline points="20 6 9 17 4 12"/></svg></div>
          <span>Testing "${r.axis}"...</span>
        </div>
      `).join('');
      
      goToScreen('4c');
      
      let completed = 0;
      const interval = setInterval(() => {
        if (completed < selectedReframes.length) {
          document.getElementById('testItem' + completed).classList.add('done');
          completed++;
        } else {
          clearInterval(interval);
          setTimeout(() => {
            generateResults();
            goToScreen(5);
          }, 500);
        }
      }, 600);
    }
    
    function generateResults() {
      // Reasoning templates based on scores
      const reasonings = {
        highClarity: "Clear, concrete language. No jargon. Easy to understand in one read.",
        lowClarity: "Could be simpler. Some abstract terms might slow comprehension.",
        highResonance: "Strong alignment with audience values and priorities.",
        lowResonance: "May not connect to what this audience cares about most.",
        highThreat: "Positions audience positively. No implied criticism.",
        lowThreat: "Could feel slightly accusatory or create defensiveness.",
        highDiff: "Distinct framing. Hard for competitors to copy or undermine.",
        lowDiff: "Generic enough that others could say the same thing."
      };
      
      testResults = selectedReframes.map(r => {
        const clarity = 50 + Math.floor(Math.random() * 45);
        const resonance = 50 + Math.floor(Math.random() * 45);
        const lowThreat = 50 + Math.floor(Math.random() * 45);
        const differentiation = 50 + Math.floor(Math.random() * 45);
        const overall = Math.round((clarity + resonance + lowThreat + differentiation) / 4);
        
        // Generate reasoning based on weakest score
        const scores = {clarity, resonance, lowThreat, differentiation};
        const weakest = Object.entries(scores).sort((a,b) => a[1] - b[1])[0];
        const strongest = Object.entries(scores).sort((a,b) => b[1] - a[1])[0];
        
        let reasoning = '';
        if (strongest[1] >= 80) {
          reasoning = strongest[0] === 'clarity' ? reasonings.highClarity :
                     strongest[0] === 'resonance' ? reasonings.highResonance :
                     strongest[0] === 'lowThreat' ? reasonings.highThreat :
                     reasonings.highDiff;
        }
        if (weakest[1] < 65) {
          reasoning += (reasoning ? ' ' : '') + (
            weakest[0] === 'clarity' ? reasonings.lowClarity :
            weakest[0] === 'resonance' ? reasonings.lowResonance :
            weakest[0] === 'lowThreat' ? reasonings.lowThreat :
            reasonings.lowDiff
          );
        }
        if (!reasoning) {
          reasoning = "Balanced across all dimensions. Solid overall performance.";
        }
        
        return {
          ...r,
          overall,
          clarity,
          resonance,
          lowThreat,
          differentiation,
          reasoning
        };
      });
      
      testResults.sort((a, b) => b.overall - a.overall);
      winnerReframe = testResults[0];
      
      const container = document.getElementById('resultCards');
      container.innerHTML = '';
      testResults.forEach((r, index) => {
        const isWinner = index === 0;
        const card = document.createElement('div');
        card.className = 'result-card' + (isWinner ? ' winner' : '');
        card.innerHTML = `
          ${isWinner ? '<div class="winner-label">🏆 Winner</div>' : ''}
          <div class="result-header">
            <div class="result-rank">
              <div class="rank-badge">${index + 1}</div>
              <div class="result-axis">${r.axis || 'Option ' + (index + 1)}</div>
            </div>
            <div class="result-score">
              <div class="result-score-value">${r.overall}%</div>
              <div class="result-score-label">Overall</div>
            </div>
          </div>
          <div class="result-text">${r.text}</div>
          <div class="result-reasoning">${r.reasoning}</div>
          <div class="result-metrics">
            <div class="metric"><span class="metric-label">Clarity</span><span class="metric-value">${r.clarity}%</span></div>
            <div class="metric"><span class="metric-label">Resonance</span><span class="metric-value">${r.resonance}%</span></div>
            <div class="metric"><span class="metric-label">Low threat</span><span class="metric-value">${r.lowThreat}%</span></div>
            <div class="metric"><span class="metric-label">Differentiation</span><span class="metric-value">${r.differentiation}%</span></div>
          </div>
        `;
        container.appendChild(card);
      });
    }
    
    function skipTest() {
      winnerReframe = selectedReframes[0];
      winnerReframe.overall = selectedTechnique.score;
      finishWithReframe(winnerReframe);
    }
    
    function useWinner() {
      finishWithReframe(winnerReframe);
    }
    
    function finishWithReframe(reframe) {
      document.getElementById('finalReframe').textContent = '"' + reframe.text + '"';
      document.getElementById('summaryRootCause').textContent = rootCauses[selectedRootCause || 'identity_threat'].label;
      document.getElementById('summaryTechnique').textContent = selectedTechnique.name;
      document.getElementById('summaryAngle').textContent = reframe.axis;
      document.getElementById('summaryScore').textContent = reframe.overall + '%';
      goToScreen(6);
    }
    
    function setLearnTab(tab, btn) {
      currentLearnTab = tab;
      document.querySelectorAll('.learn-nav-btn').forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      document.getElementById('learnBrowse').style.display = tab === 'browse' ? 'block' : 'none';
      document.getElementById('learnFlashcards').style.display = tab === 'flashcards' ? 'block' : 'none';
      document.getElementById('learnCases').style.display = tab === 'cases' ? 'block' : 'none';
      
      if (tab === 'flashcards') updateFlashcard();
    }
    
    function updateFlashcard() {
      const tech = allTechniques[currentCardIndex];
      document.getElementById('flashcardTitle').textContent = tech.name;
      document.getElementById('flashcardTitleBack').textContent = tech.name;
      document.getElementById('flashcardFamily').textContent = tech.family;
      document.getElementById('flashcardWhen').textContent = tech.when;
      document.getElementById('flashcardDef').textContent = tech.def;
      document.getElementById('cardIndex').textContent = currentCardIndex + 1;
      document.getElementById('cardTotal').textContent = allTechniques.length;
      document.getElementById('flashcard').classList.remove('flipped');
    }
    
    function flipCard() {
      document.getElementById('flashcard').classList.toggle('flipped');
    }
    
    function nextCard() {
      currentCardIndex = (currentCardIndex + 1) % allTechniques.length;
      updateFlashcard();
    }
    
    function prevCard() {
      currentCardIndex = (currentCardIndex - 1 + allTechniques.length) % allTechniques.length;
      updateFlashcard();
    }
    
    function goToScreen(index) {
      const stringScreens = ['landing', 'intro1', 'intro2', 'intro3', '1b', '4b', '4c', '3b', '3c', '7b', '7c'];
      const hideUI = ['landing', 'intro1', 'intro2', 'intro3'].includes(index);
      
      document.getElementById('header').classList.toggle('hidden', hideUI);
      document.getElementById('progressBar').classList.toggle('hidden', hideUI);
      
      document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
      
      if (stringScreens.includes(index)) {
        const screenId = 'screen' + index.charAt(0).toUpperCase() + index.slice(1);
        document.getElementById(screenId).classList.add('active');
        return;
      }
      
      document.getElementById('screen' + index).classList.add('active');
      currentScreen = index;
      updateProgress();
      
      const labelMap = {0: 'Start', 1: 'Intake', 2: 'Diagnosis', 3: 'Techniques', 4: 'Style', 5: 'Results', 6: 'Done', 7: 'Learn'};
      document.getElementById('screenLabel').textContent = labelMap[index] || '';
    }
    
    function updateProgress() {
      const progressMap = {0: 0, 1: 1, 2: 2, 3: 3, 4: 4, 5: 5, 6: 5, 7: 0};
      const pos = progressMap[currentScreen] || 0;
      for (let i = 0; i < 6; i++) {
        const dot = document.getElementById('dot' + i);
        dot.classList.remove('active', 'completed');
        if (i === pos) dot.classList.add('active');
        else if (i < pos) dot.classList.add('completed');
      }
    }
    
    function resetApp() {
      document.getElementById('messageInput').value = '';
      document.getElementById('audienceInput').value = '';
      document.querySelectorAll('.reaction-btn').forEach(b => b.classList.remove('selected'));
      selectedReaction = null;
      selectedRootCause = null;
      selectedTechnique = null;
      selectedReframes = [];
      allReframes = [];
      generatedCount = 0;
      testResults = [];
      winnerReframe = null;
      document.getElementById('btnAnalyze').disabled = true;
      document.getElementById('btnTest').disabled = true;
      document.getElementById('btnSkipTest').disabled = true;
      goToScreen(0);
    }
    
    // Init
    buildLearnFamilyList();
  </script>
</body>
</html>
